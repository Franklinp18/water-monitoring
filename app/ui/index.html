<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HydroMonitor - Plataforma</title>
  <link rel="stylesheet" href="/assets/styles.css" />
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">üíß</div>
      <div class="brand-text">
        <div class="brand-title">HydroMonitor <span class="accent">Local</span></div>
        <div class="brand-sub">Plataforma de m√©tricas ‚Ä¢ JAAPRV</div>
      </div>
    </div>

    <div class="topbar-actions">
      <button class="btn primary" id="btn-add" type="button">+ Agregar m√©trica</button>

      <!-- NUEVO: Toggle claro/oscuro -->
      <button class="icon-btn" id="theme-toggle" type="button"
              aria-label="Cambiar tema" title="Cambiar tema">‚òÄÔ∏è</button>
    </div>
  </header>

  <main class="layout">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-head">
        <div class="sidebar-head-text">
          <div class="sidebar-title">M√©tricas</div>
          <div class="sidebar-sub">Crea y administra widgets</div>
        </div>

        <!-- Toggle collapse -->
        <button class="icon-btn" id="sidebar-toggle" type="button" title="Colapsar/Expandir">
          <span class="chev" aria-hidden="true">‚ùÆ</span>
        </button>
      </div>

      <div class="sidebar-list" id="metrics-list"></div>

      <div class="sidebar-footer">
        <div class="hint">
        </div>
      </div>
    </aside>

    <!-- Content -->
    <section class="content">
      <div class="content-head">
        <div>
          <h2>Dashboard</h2>
          <p id="subtitle">Sin m√©tricas a√∫n. Crea la primera con ‚ÄúAgregar m√©trica‚Äù.</p>
        </div>
      </div>

      <div class="grid" id="grid"></div>

      <div class="empty" id="empty">
        <div class="empty-card">
          <div class="empty-title">Tu dashboard est√° vac√≠o</div>
          <div class="empty-sub">Agrega un KPI, una serie (l√≠nea), barras o una tabla.</div>
          <button class="btn primary" id="btn-add-empty" type="button">+ Agregar m√©trica</button>
        </div>
      </div>

      <footer class="footer">
        COPYRIGHT 2026 ¬© El contenido de esta obra es de propiedad intelectual de la ESPOL. Todos los derechos reservados.
      </footer>
    </section>
  </main>

  <!-- Modal -->
  <div class="modal-backdrop hidden" id="modal-backdrop">
    <div class="modal">
      <div class="modal-top">
        <div>
          <div class="modal-title">Agregar m√©trica</div>
          <div class="modal-sub">Define qu√© topic MQTT escuchar y c√≥mo se visualiza.</div>
        </div>
        <button class="icon-btn" id="btn-close" title="Cerrar" type="button">‚úï</button>
      </div>

      <form id="metric-form" class="form">
        <div class="row">
          <label>
            <span>Nombre</span>
            <input name="name" placeholder="Ej: Humedad de Suelo" required />
          </label>

          <label>
            <span>Key (identificador)</span>
            <input name="key" placeholder="Ej: humedad_suelo" required />
          </label>
        </div>

        <div class="row">
          <label>
            <span>Tipo de widget</span>
            <select name="type" required>
              <option value="kpi">KPI (n√∫mero grande)</option>
              <option value="line">Serie (l√≠nea)</option>
              <option value="bar">Barras</option>
              <option value="table">Tabla (√∫ltimas lecturas)</option>
            </select>
          </label>

          <label>
            <span>Unidad</span>
            <input name="unit" placeholder="Ej: %, PSI, ¬∞C, pH" />
          </label>
        </div>

        <div class="row">
          <label style="width:100%;">
            <span>Topic MQTT (filtro)</span>
            <input name="topic"
              placeholder="Ej: hydromonit/+/humedad_suelo  (usa + y #)"
              required />
          </label>
        </div>

        <div class="row">
          <label>
            <span>Descripci√≥n (opcional)</span>
            <input name="desc" placeholder="Ej: Sensor FC-28 / ESP32" />
          </label>
        </div>

        <div class="row">
          <label class="checkbox">
            <input type="checkbox" name="demo" />
            <span>Modo demo (ignora MQTT y simula datos)</span>
          </label>
        </div>

        <div class="actions">
          <button class="btn ghost" type="button" id="btn-cancel">Cancelar</button>
          <button class="btn primary" type="submit">Crear m√©trica</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Chart.js local -->
  <script src="/assets/vendor/chart.umd.min.js"></script>

  <!-- NUEVO: Theme toggle -->
  <script src="/assets/theme.js"></script>

  <script src="/assets/app.js"></script>
</body>
</html>
